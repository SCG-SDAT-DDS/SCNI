@model Datos.DTO.Infraestructura.ViewModels.MunicipioViewModel

<script type="text/javascript">
    $(document).ready(function () {
        var $ddlEstado = $('#@Model.CampoEstado.Replace(".", "_")'),
            $ddlMunicipio = $('#@Model.CampoMunicipio.Replace(".", "_")'),
            $ddlColonia = $("#Colonia_IDColonia"),
            $txtCodigoPostal = $("#Colonia_CodigoPostal");

        $ddlEstado.change(function () {
            cargarMunicipiosDdl($ddlEstado.val());
        });

        function cargarMunicipiosDdl(idEstado) { 

            if (idEstado > 0) {
                $.ajax({
                    data: "{idEstado: " + idEstado + "}",
                    dataType: "json",
                    contentType: "application/json",
                    type: "POST",
                    url: '@Url.Action("ObtenerMunicipios", this.ViewContext.RouteData.Values["controller"].ToString() == "SolicitudWeb" ? "SolicitudWeb" : "Municipio", new { area = string.Empty })',
                    beforeSend: function () {
                        MostrarMensajeCargando($ddlMunicipio);
                    },
                    success: function (data) {
                        CargarDdl($ddlMunicipio, data);
                        var hfd_municipio = $("#hdf_idmunicipio_deafult").val();
                        $ddlMunicipio.val(hfd_municipio > 0 ? hfd_municipio : $("#" + $ddlMunicipio.id + " option:first").val());
                        DeshabilitarDdl($ddlColonia);
                        $txtCodigoPostal.val("");
                        CerrarMensajeCargando();
                    },
                    error: function (error) {
                        CerrarMensajeCargando();
                    }
                });
            } else {
                deshabilitarMunicipio();
        }
    }


    function deshabilitarMunicipio() {
        $ddlMunicipio.empty();
        $ddlMunicipio.attr("disabled", "disabled");
    }
    });
</script>
