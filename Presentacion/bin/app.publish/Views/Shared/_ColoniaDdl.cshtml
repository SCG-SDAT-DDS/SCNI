@model Datos.DTO.Infraestructura.ViewModels.ColoniaViewModel

<script type="text/javascript">
    $(document).ready(function () {
        var $ddlEstado = $("#Colonia_IDEstado"),
            $ddlMunicipio = $("#Colonia_IDMunicipio"),
            $ddlColonia = $("#Colonia_IDColonia"),
            $txtColonia = $("#Colonia_Nombre"),
            $txtCodigoPostal = $("#Colonia_CodigoPostal");

        $ddlMunicipio.change(function () {
            cargarColoniasDdl($ddlMunicipio.val());
        });

        function cargarColoniasDdl(idMunicipio) {

            if (idMunicipio > 0) {
                $.ajax({
                    url: '@Url.Action("ListaColonias", "Colonia", new { area = "Catalogo" })',
                    data: "{idMunicipio: " + $ddlMunicipio.find(":selected").val() + ", " + "idEstado: " + $ddlEstado.find(":selected").val() + ", " + "buscar:''}",//" + request.term + "'}",
                    dataType: "json",
                    contentType: "application/json",
                    type: "POST",
                    beforeSend: function () {
                        MostrarMensajeCargando($ddlColonia);
                    },
                    success: function (data) {
                        CargarDdl($ddlColonia, data);
                        
                        $txtCodigoPostal.val("");
                        CerrarMensajeCargando();
                    },
                    error: function (error) {
                        CerrarMensajeCargando();
                    }
                });
            } else {
                deshabilitarColonia();
            }
        }

        function deshabilitarColonia() {
            $ddlColonia.empty();
            $ddlColonia.attr("disabled", "disabled");
        }
    });
</script>
